$PSDocId: Document Release 1.0 for Run-time Library Release 4.4$

TMDVIEW4	GsDOBJ2 型 オブジェクトを使ったTMDビューワー

                      Copyright(C) 1997 Sony Computer Entertainment Inc.
                                                    All Rights Reserved.

tuto0
=====

<サンプルの解説>

tuto0:	最もsimpleなGsDOBJ2ビューワー
=====

	GsDOBJ2というオブジェクトは 最も標準的なオブジェクト
	ハンドラです。クリップされたパケットは作成しないため
	パケットのメモリ効率は高いです。
	
	オブジェクトの使い回し（同じモデルを 違うオブジェクト
	ハンドラで表示する）も可能です。

	オブジェクトの計算ルーチンは GsSortObject4()を使います。

	自動分割機能とは、アトリビュートに自動分割数を設定すると
	実行時にそのオブジェクトの表示されるポリゴンの全てを
	分割するものです。


<起動方法>

	>psymake tuto0
	>psymake load
	>run tuto0


<コントローラの操作方法>

        ○ : オブジェクトの回転（右）
	△ : オブジェクトの回転（上）
	□ : オブジェクトの回転（左）
	× : オブジェクトの回転（下）
	方向キー : オブジェクトの平行移動
	R1 : オブジェクトの平行移動（手前）
	R2 : オブジェクトの平行移動（奥）
        SELECT : プログラム終了



tuto1:	tuto0.cをGsSortObject4J()を使って書き換えたサンプル
=====

＜サンプルの解説＞

	このプログラムは GsSortObject4()をGsSortObject4J()に
	書き換えたものです。GsSortObject4J()を使うことで
	GsSortObject4()で呼んでいる 下位関数のうち 不要なものを
	リンクせず コードを小さくすることができます。

	変更した部分は init_all()中で jt_init()を呼ぶようにしたことと
	GsSortObject4 -> GsSortObject4J に変えた部分だけです。

	jt_init()の中では GsTMDfastF3L,GsTMDfastTF3Lのみを登録して
	いるので光源計算型のフラット３角形 でかつ 標準の光源計算を
	する機能しかありません。よって自動分割、FOG計算、光源計算OFFを
	設定することはできません。

	ただし 機能を絞っていることで コードサイズは tuto0に比べて
	48Kbyteも減少しています。

	もし より多くの機能を使う場合は それに応じた関数をテーブルに
	登録すればいいのです。全ての関数をテーブルに登録すると
	GsSortObject4()とコンパチになります。
	GsSortObject4()とコンパチになる jt_init()のひな型が
	libgs.hにコメントとして入っています。jt_init4()

	GsSortObject4() どの下位関数が使われているかを 調べるには
	取り敢えず dmyを先頭につけた関数を登録してみてください。
	（dmyGsTMDfastF3L,dmyGsTMDfastTF3Lなど）
	この関数は 最初に呼ばれた時に その関数の タイプをprintf
	します。


<起動方法>

	>psymake tuto1
	>psymake load1
	>run tuto1

<コントローラの操作方法>

        ○ : オブジェクトの回転（右）
	△ : オブジェクトの回転（上）
	□ : オブジェクトの回転（左）
	× : オブジェクトの回転（下）
	方向キー : オブジェクトの平行移動
	R1 : オブジェクトの平行移動（手前）
	R2 : オブジェクトの平行移動（奥）
        SELECT : プログラム終了


＜備考＞

【モデリングデータ】
	cube3.tmdに限定


tuto2:	能動的自動分割を行なう
=====

<サンプルプログラムの説明＞

	このプログラムは 能動的自動分割を行ないます。
	能動的自動分割を実現する下位関数群 GsA4div...()を
	ジャンプテーブル経由で呼び出すことでこの機能を
	使うことができます。
	
	下位関数のコードサイズは小さくはないので 不要なポリゴン
	タイプの下位関数は ジャンプテーブルに登録しないで下さい。

	能動的自動分割の条件は GsSetAzwh(z,w,h)により指定します。
	zは 能動的自動分割を開始するための near Z値です。
	この zよりも遠いポリゴンは分割されません。
	w,hは分割後のポリゴンの大きさを規定します。分割後のポリゴンの
	大きさがこのw,hよりも大きいと 更に分割を繰り返します。
	ただし 分割の最大値は attributeの分割数で 決められているので
	それ以上は分割しません。


<起動方法>

	>psymake tuto2
	>psymake load
	>run tuto2


<コントローラの操作方法>

        ○ : オブジェクトの回転（右）
	△ : オブジェクトの回転（上）
	□ : オブジェクトの回転（左）
	× : オブジェクトの回転（下）
	方向キー : オブジェクトの平行移動
	R1 : オブジェクトの平行移動（手前）
	R2 : オブジェクトの平行移動（奥）
        SELECT : プログラム終了

		
tuto3:	GsDOBJ2を使った スプリット画面のサンプル
=====

<サンプルプログラムの説明＞

	このプログラムは、画面を２分割して別々の視点から眺められる
	ようにしたものです。

	モデリングデータは、上下の画面とも共用で使っていますが、
	オブジェクトハンドラは、上下の画面で別々に用意しています。

	LIBGPUがキューイングするため、Draw命令は、連続的に
	送っても キューにつまれ すぐにリターンします。


＜起動方法＞

	>psymake tuto3	コンパイル＆必要なファイルを読み込み(tuto3)
	>psymake load
	>run tuto3

<コントローラの操作方法>

        ○ : オブジェクトの回転（右）
	△ : オブジェクトの回転（上）
	□ : オブジェクトの回転（左）
	× : オブジェクトの回転（下）
	方向キー : オブジェクトの平行移動
	R1 : オブジェクトの平行移動（手前）
	R2 : オブジェクトの平行移動（奥）
        SELECT : プログラム終了


tuto4:	GsDOBJ2を使ったオブジェクトの使い回し 及び 複数オーダリングテーブル
======

<サンプルプログラムの説明＞

	このプログラムは、オブジェクトを使い回し、複数のOTに
	それぞれを割り当てた 複数OTのサンプルです。

	GsClearOt(offset,point,Wot2) で設定される Wot2のpointが
	GsSortOt(Wot2,Wot1)で参照され、Wot1のZテーブルに割り付け
	られます。

	サンプルでWot2のpointは、０でコールしていますので 必ず
	Wot2にソートされたオブジェクト２の方が、手前になります。
	コメントされているpointは、1<<OT_LENGTH-1です。これで
	コールすれば、オブジェクト２の方が必ず奥になります。


＜起動方法＞

	>psymake tuto4
	>psymake load
	>run tuto4

<コントローラの操作方法>

        ○ : オブジェクト０の回転（右）
	△ : オブジェクト０の回転（上）
	□ : オブジェクト０の回転（左）
	× : オブジェクト０の回転（下）
	方向キー : オブジェクト１の回転
	R1 : オブジェクト０の平行移動（手前）
	R2 : オブジェクト０の平行移動（奥）
	L1 : オブジェクト１の平行移動（手前）
	L2 : オブジェクト１の平行移動（奥）
        SELECT : プログラム終了



tuto5:	マルチスクリーン座標系
======
<サンプルプログラムの説明＞

	このプログラムは SCREEN座標のスケーリングを変える関数
	GsSetScreenScale()を用いたサンプルです。

	スクリーン座標系のスケーリングを変えることによって
	視点とオブジェクトの距離が16bitを超えても クリップする
	ことなく 表示できるようになります。

	例えば このサンプルでは スクリーン座標系を1/8にスケーリング
	しているため オブジェクトと視点がの距離が１６ビットを超えても
	１９ビット以内であれば 表示可能です。

	注意事項として スクリーン座標系をスケーリングすると 
	OTのスケールも変化します。スケールの違うスクリーン座標系
	で計算したオブジェクトは 同じスケールでOTに登録しては
	いけません。

	例えば 1/8スケールのスクリーン座標系で計算したオブジェクト
	を ソートしたOTに ノーマルスケーリングのスクリーン座標で
	計算したオブジェクトをソートするには SortObjectのshift値を
	３余計に増やす必要があります。


＜起動方法＞

	>psymake tuto5
	>psymake load
	>run tuto5

＜コントローラの操作方法＞

        ○ : オブジェクトの回転（右）
	△ : オブジェクトの回転（上）
	□ : オブジェクトの回転（左）
	× : オブジェクトの回転（下）
	方向キー : オブジェクトの平行移動
	R1 : オブジェクトの平行移動（手前）
	R2 : オブジェクトの平行移動（奥）
	L1 : screen座標 1/8 SCALING
	L2 : screen座標 NORMAL SCALING
        SELECT : プログラム終了


tuto6:	tuto0.cをモデルを動かすのではなく 視点を主観的に動かしたサンプル
=====
<サンプルプログラムの説明>

	このプログラムは 視点を主観的に動かすサンプルです。
	キーにアサインされている 動きは全て視点座標系に従います。
	例えばZ軸の平行移動をすると 視線の方向に進みます。
	回転移動は 視線の方向を変化させます。

	プログラムは 座標系を一つ用意し（DView) その座標系にカメラを
	ぶら下げています。DViewを 主観的に動かしたいため 平行移動
	は DView内での移動に Dview.coordを掛けてWorld座標系の
	移動に変換して指定しています。

	回転移動に関しては tuto0の様に 回転角から 毎フレーム回転
	マトリックスを求めると 主観的移動では計算が複雑化するため
	直前のフレームのマトリックスを使って計算しています。

	しかし この計算法では誤差が蓄積されてしまうので 形が
	歪んできてしまいます。それを避けるために MatrixNormal()
	をコールしています。MatrixNormal()は 形を歪めるマトリックス
	を 歪めないマトリックスへ正規化します。

	ただし 平行移動に関しては このプログラムでは正規化していない
	ので 誤差が蓄積されてしまいます。その弊害として 例えば
	中心を回る軌道が 長時間回り続けると 中央に縮退するなどの
	弊害があるので注意が 必要です。

<起動方法>
	>psymake tuto6
	>psymake load
	>run tuto6

<コントローラの操作方法>

        ○ : 視点の回転（右）
	△ : 視点の回転（上）
	□ : 視点の回転（左）
	× : 視点の回転（下）
	方向キー : 視点の平行移動
	R1 : 視点のZ軸の平行移動(手前）
	R2 : 視点のZ軸の平行移動(奥）
	L1 : 視点のZ軸回りの回転(時計回り）
	L2 : 視点のZ軸回りの回転（半時計回り）
        SELECT : プログラム終了



tuto7:	tuto1.cをGsSortObject4J()を使って書き換え、GsDOBJ2のマテリ
======	アル減衰に対応した下位関数を登録して使用するサンプル

<サンプルプログラムの説明>

	このプログラムは GsSortObject4()をGsSortObject4J()に
	書き換えたものです。GsSortObject4J()を使うことで
	GsSortObject4()で呼んでいる 下位関数のうち 不要なものを
	リンクせず コードを小さくすることができます。

	このサンプルでは、光源計算あり、もしくは、FOG使用時
	のみマテリアル減衰が有効になるように記述されています。

<起動方法>

	>psymake tuto7
	>psymake load
	>run tuto7

<コントローラの操作方法>

        ○ : オブジェクトの回転（右）
	△ : オブジェクトの回転（上）
	□ : オブジェクトの回転（左）
	× : オブジェクトの回転（下）
	方向キー : オブジェクトの平行移動
	R1 : オブジェクトの平行移動（手前）
	R2 : オブジェクトの平行移動（奥）
        SELECT : プログラム終了




<備考>

【モデリングデータ】

		モデリングデータは、以下の１６種類が用意されています。
		ファイル名の gは、 グーローシェーディングデータを
			     tは、 半透明データを
			     lは、 光源計算なしデータを表します。

		モデリングの形状は、すべて立方体でそのうち３面には
		テクスチャは張っておらず、残りの３面には、15bit,8bit,4bit
		のテクスチャが張ってあります。

		このプログラムは、モデリングデータを入れ換えるだけで
		ここにある１６種類すべてのデータをビューイングできます。

		cube3.tmd		フラット３角ポリゴン
		cube3g.tmd		グーロー３角ポリゴン
		cube3gl.tmd		グーロー光源計算なし３角ポリゴン
		cube3gt.tmd		グーロー半透明３角ポリゴン
		cube3gtl.tmd		グーロー半透明光源計算なし３角ポリゴン
		cube3l.tmd		フラット光源計算なし３角ポリゴン
		cube3t.tmd		フラット半透明３角ポリゴン
		cube3tl.tmd		フラット半透明光源計算なし３角ポリゴン

		cube4.tmd		フラット4角ポリゴン
		cube4g.tmd		グーロー4角ポリゴン
		cube4gl.tmd		グーロー光源計算なし4角ポリゴン
		cube4gt.tmd		グーロー半透明4角ポリゴン
		cube4gtl.tmd		グーロー半透明光源計算なし4角ポリゴン
		cube4l.tmd		フラット光源計算なし4角ポリゴン
		cube4t.tmd		フラット半透明4角ポリゴン
		cube4tl.tmd		フラット半透明光源計算なし4角ポリゴン

		また 一般的な モデリングデータ shuttle1.tmdも用意しました。


【テクスチャデータ】
		テクスチャデータは、6種類が用意されている。

		pat4.tim		4bitテクスチャデータ
		pat8.tim		8bitテクスチャデータ
		pat16.tim		16bitテクスチャデータ
		pat4t.tim		4bitテクスチャデータ(半透明）
		pat8t.tim		8bitテクスチャデータ（半透明）
		pat16t.tim		16bitテクスチャデータ（半透明）

